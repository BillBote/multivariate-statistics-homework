rawdata<-read.table("MS-Ch8-1.txt")
#################主成分分析法进行因子分析###################
S<-as.matrix(rawdata)
#计算相关系数阵S的特征值和特征向量
eigenVal<-eigen(S)$value
eigenVec<-eigen(S)$vector
#输出如下：
#特征值：
#> eigen$values
#[1]  7.37054432  2.05546376  1.41719997  1.16542051  0.93367600  0.70643658  0.47840098  0.33301510  0.26750672
#[10]  0.22450870  0.17996090  0.12880486  0.07303563  0.03997948 -0.37395349
#特征向量：
#> eigenVec
#[,1]         [,2]        [,3]          [,4]          [,5]        [,6]         [,7]         [,8]
#[1,] -0.16806423  0.413289360 -0.35191302 -0.0068995947  0.1013293722  0.12923728  0.631121851  0.200201214
#[2,] -0.21641235 -0.040707309  0.05803631  0.2570434826 -0.2973894972  0.82719890 -0.004930564  0.039343540
#[3,] -0.04126342  0.234968287  0.51051007  0.5759849704  0.0456243954 -0.23712759  0.201365871  0.306398521
#[4,] -0.23096457 -0.161730008 -0.40536702  0.4082158322  0.0007736084 -0.17022471  0.078925187 -0.110751707
#[5,] -0.26235314 -0.260581900  0.20956447 -0.1367598497  0.6106054785  0.24739073  0.064969365  0.055889955
#[6,] -0.32113885 -0.136837658  0.17866561 -0.1447682177  0.0503026256 -0.15994218  0.208359966 -0.435306432
#[7,] -0.16118807 -0.434674298 -0.19415986  0.4339908470  0.0348361967 -0.05550085 -0.310703356  0.069369948
#[8,] -0.32658351 -0.038468077  0.19536819 -0.2873666989 -0.0287916566  0.07207935 -0.061832873  0.106368402
#[9,] -0.13798916  0.539498686 -0.08955930  0.1243758181  0.1971497501 -0.04824256 -0.383519033 -0.339121911
#[10,] -0.32011420  0.041602535  0.07846680 -0.1991803590  0.0515853517 -0.17544116 -0.267485830  0.574749046
#[11,] -0.29342724  0.042222454  0.07124072 -0.1614827275 -0.6844843307 -0.16628347 -0.017075621  0.008103447
#[12,] -0.33708868 -0.032144575  0.15272431  0.0289347849 -0.0106200639 -0.06343405  0.170337185 -0.397624936
#[13,] -0.33983797  0.006819823  0.11644253  0.1573541138 -0.0052912442 -0.13611425  0.055481215  0.005863413
#[14,] -0.26455664 -0.103279581 -0.48028352 -0.1344506278  0.0425750523 -0.12816894  0.062024578  0.196032404
#[15,] -0.24197644  0.403485222 -0.09660041  0.0002873505  0.0989770037  0.13798160 -0.389899554 -0.038849550
#[,9]        [,10]       [,11]       [,12]        [,13]        [,14]        [,15]
#[1,] -0.12774175 -0.322162215  0.16126830  0.24529955 -0.039246339 -0.051722574  0.034488092
#[2,] -0.07291980  0.151163449 -0.09580914 -0.03222106  0.209461696  0.052622275 -0.150896317
#[3,]  0.00835185  0.201564126  0.24732414 -0.21428536  0.057936390  0.067670941  0.047406766
#[4,]  0.46451985  0.359183702 -0.12982681  0.24959760  0.071936169 -0.320620968  0.100726384
#[5,] -0.04644940  0.086089719 -0.07344268  0.01190025 -0.017744147 -0.003445548  0.586370440
#[6,]  0.10360290 -0.031735245  0.25022026  0.18590778  0.513498113  0.383921553 -0.210380612
#[7,] -0.30842728 -0.437230343  0.37070367  0.13083136 -0.096894459  0.056232174  0.001212852
#[8,]  0.09378505  0.305002649  0.43264238  0.24851268 -0.525104212 -0.167527724 -0.308857460
#9,] -0.48001950  0.283664131 -0.02937371  0.21656193  0.044706908 -0.026181193  0.042355101
#[10,] -0.04019291 -0.120832746 -0.24076121  0.13076753  0.452235431 -0.273195198 -0.210251890
#[11,] -0.10828734 -0.005140945  0.04741506  0.05800734 -0.007421988  0.025832359  0.605269825
#[12,] -0.15415335 -0.246133287 -0.11563003 -0.47270572 -0.080199825 -0.567384352 -0.142815025
#[13,]  0.01925886 -0.143700556 -0.61495541  0.12809514 -0.427099135  0.446359933 -0.165005144
#[14,] -0.21088250  0.368718520  0.07943553 -0.57098092  0.006897158  0.299476273 -0.087124201
#[15,]  0.57735279 -0.314368292  0.18776804 -0.28939886 -0.038366864  0.147331842  0.112241445
(eigenVal[1]+eigenVal[2]+eigenVal[3]+eigenVal[4])/sum(eigenVal)
#由于其前4个特征值贡献占了0.8，因此考虑前4个主成分，将其作为四个公共因子
#计算四个公共因子对应的载荷阵
f<-c()
for(i in 1:4){
  f<-cbind(f,sqrt(eigenVal[i])*eigenVec[,i])
}
f[,1]<-f[,1]*(-1)
#载荷阵：
#          [,1]         [,2]        [,3]          [,4]
#[1,] 0.4562733  0.592528353 -0.41893911 -0.0074484328
#[2,] 0.5875324 -0.058361615  0.06909003  0.2774903755
#[3,] 0.1120250  0.336871416  0.60774288  0.6218025218
#[4,] 0.6270399 -0.231870512 -0.48257407  0.4406879467
#[5,] 0.7122559 -0.373593369  0.24947855 -0.1476386083
#[6,] 0.8718517 -0.196182627  0.21269463 -0.1562840134
#[7,] 0.4376054 -0.623187701 -0.23113995  0.4685132721
#[8,] 0.8866333 -0.055151254  0.23257842 -0.3102256955
#[9,] 0.3746233  0.773473259 -0.10661695  0.1342694711
#[10,] 0.8690699  0.059645091  0.09341174 -0.2150244466
#[11,] 0.7966182  0.060533862  0.08480938 -0.1743281029
#[12,] 0.9151535 -0.046085319  0.18181250  0.0312364439
#[13,] 0.9226175  0.009777504  0.13862042  0.1698710727
#[14,] 0.7182381 -0.148070786 -0.57175932 -0.1451456960
#[15,] 0.6569357  0.578472270 -0.11499913  0.0003102082
#########################分析###########################
#1.首先观察第一列，由于其全是正值，且除个别因子外相差不大，可将其视为全面素质和能力的因子；
#2.再考察第二列因子，其以1、9、15的系数较大，因此可以概括为一种经验因子；
#3.再观察第三列因子，3的系数最大，概括为一种知识水平因子；
#4.最后观察第四列因子，3、4、7的系数较大，比较难概括。


#根据上面的分析发现，用主成分法找出的有些因子难以分析，因此用方差最大化旋转处理载荷阵
rotate<-varimax(f)
rotate$rotmat
f.rotate<-f%*%rotate$rotmat
#得到旋转矩阵为：
#           [,1]        [,2]        [,3]       [,4]
#[1,]  0.8385768  0.37660924 0.003168801  0.3936298
#[2,] -0.1735306  0.84223419 0.261679027 -0.4382383
#[3,]  0.3952406 -0.38156129 0.682238476 -0.4824381
#[4,] -0.3323566  0.05672766 0.682689319  0.6482718
#旋转后的载荷阵为：
#           [,1]        [,2]          [,3]         [,4]
#[1,] 0.11669218  0.83031280 -0.1344032601  0.117217738
#[2,] 0.43789999  0.16149529  0.2231653532  0.403404078
#[3,] 0.06902856  0.12929653  0.9276306833  0.006365187
#[4,] 0.22885926  0.24999051 -0.0870663268  0.866933763
#[5,] 0.80978387 -0.14997751 -0.0260919880  0.228020148
#[6,] 0.90116590  0.07309404 -0.0101591202  0.225235036
#[7,] 0.22803850 -0.24529203  0.0004679752  0.860593872
#[8,] 0.94811055  0.18112272 -0.0647361823  0.059859413
#[9,] 0.09316437  0.84082990  0.2225149818 -0.053023513
#[10,] 0.82681654  0.32969477 -0.0647040281  0.131493388
#[11,] 0.74898024  0.30874825 -0.0427869465  0.133117120
#[12,] 0.83690175  0.23824000  0.1362046504  0.312964464
#[13,] 0.77031955  0.31244542  0.2160235070  0.402131709
#[14,] 0.45025024  0.35571228 -0.5256366866  0.529354793
#[15,] 0.40495295  0.77851400  0.0752107065  0.060761835
#再次分析因子：
#1.第一列中5、6、8、10、11、12、13的系数较大，可以概括为能力因子；
#2.第二列中1、9、15的系数较大，可以概括为经验因子；
#3.第三列中3的系数远超过其他项，可以概括为知识水平因子；
#4.第四列中4、7的系数较大，可以概括为品质因子。
